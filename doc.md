## 静的解析ツールイントロ

### 静的解析とは？
プログラミングをするにあたり、自分の書いたプログラムが求められている仕様通りに動いているかを確認するには幾つかの方法が取れます。すぐに思い付く方法としては、ソースコードを目視で確認したり、実行してその動作でプログラムの正誤を図るやり方が挙げられます。

その手法の中で、この資料では特に、ソースコードを実行せずにプログラムを書いていくと同時に自動的にソースコードを解析して問題点を指摘してくれる静的解析ツールについて簡単にまとめます。

```text
静的コード解析 (static code analysis) または静的プログラム解析 (static program analysis)とは、コンピュータのソフトウェアの解析手法の一種であり、実行ファイルを実行することなく解析を行うこと。(Wikipedia)
```

静的解析の自動化ツールを使用すれば、優れたコーディングパターンを自動的に推進でき、コードが任意のコーディング標準に準拠していることを確認できます。

今日プログラミングを行う現場でプログラマをコーディングの面から補助する目的で広く使われているツールの一つであり、代表的な統合開発環境(IDE)には標準搭載されています。
静的解析ツールを使うことは主にソースコードの品質向上の面に期待をすることが出来、ソースコードをコンパイルする必要なく、プログラムを書いている段階でプログラム上の問題点、具体的には冗長性や命名規則の問題を指摘してくれるので、以下の点が利点として挙げられます。

- プログラムの問題点の早期発見
- プログラムの可読性・保守性の向上
- 導入の容易さ

この他にも、ツールを使用しプログラミングのスタンダードを知ることによって、開発者それぞれが普段から「綺麗なソースコード」を意識して書けるようになるため、新しくプログラミング言語を学習する際には非常に役に立ちます。

ただし、静的解析だけを使っていたとしても発見できないプログラム上の問題点はいくつもあります。
文法的に正しくても、実行時にはエラーと成りうる可能性があるソースコードは検知されない可能性がある為です。
ここで、文法的に正しいプログラムだが、実行時エラーに成りうる処理とは、「例外処理」や「バッファオーバーフロー」、「メモリ破壊」などです。

これらの問題は、「単体テスト」「フロー解析」などを使いプログラムを解析する必要がありますが、新しくプログラミング言語を学び始める段階ではまだ覚える必要はありません。


### 様々な言語の静的解析ツール
現在、非常に大量の静的解析ツールが、また非常に多くの言語に対応して存在している為、それぞれのメジャーな言語についてまた著名なツールを以下で簡単に紹介します。

#### C/C++
- Coverity
- Infer
- **flymake**

#### Java
- FindBugs
-  Jtest

#### Python
- Pylint

#### Ruby
- Rubocop

#### Scala
- Scalastyle
- WartRemover

色々と挙げましたが、IDEを使っていればたいていの静的解析ツールはプラグインとして簡単に導入出来るので、これも覚える必要はありません。これ意外にも星の数ほどの静的解析ツールが存在しています。

### flymake導入
実際に、C言語の静的コード解析ツールであるflymakeをSolaris端末のemacsに導入してみましょう。以下でステップに分けて説明を行います。

```sh
$ emacs $HOME/.emacs.d/init.el
```

でEmacsの設定ファイルを開き、ファイルの末尾に以下のスクリプトを追加します。

```script
;; flymake
(require 'flymake)
(defun flymake-c-init ()
  (let* ((temp-file   (flymake-init-create-temp-buffer-copy
                       'flymake-create-temp-inplace))
         (local-file  (file-relative-name
                       temp-file
                       (file-name-directory buffer-file-name))))
    (list "gcc" (list  "-Wall" "-Wextra" "-fsyntax-only" local-file))))
(push '("\\.c$" flymake-c-init) flymake-allowed-file-name-masks)
(add-hook 'c-mode-hook
          '(lambda ()
             (flymake-mode t)))
```

このスクリプトはSlackの #general チャンネルにもアップロードしておいたので、そこからコピペすることも出来ます。
貼り付けたらEmacsを閉じます。
これでflymakeの導入は終了です。


### 参考
https://ja.wikipedia.org/wiki/%E9%9D%99%E7%9A%84%E3%82%B3%E3%83%BC%E3%83%89%E8%A7%A3%E6%9E%90  
https://www.techmatrix.co.jp/t/quality/static-analysis.html  
http://monoist.atmarkit.co.jp/mn/articles/1605/20/news004.html  